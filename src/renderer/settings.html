<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - Hintify</title>
    <!-- Material-UI Fonts and Icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="settings.css">
    <link rel="stylesheet" href="glassy-theme.css">
</head>
<body class="theme-dark" id="settings-body">
<script>
    // Load glassy mode preference
    const Store = require('electron-store');
    const store = new Store();
    if (store.get('glassy_mode', false)) {
        document.body.classList.add('glassy-mode');
        document.documentElement.classList.add('theme-glassy');
    }
</script>
    <div class="settings-container">
        <div class="settings-header">
            <h1>Settings</h1>
            <p>Configure Hintify to your preferences</p>
        </div>

        <div class="settings-content">
            <!-- User section -->
            <div class="user-card">
                <div class="user-left">
                    <div class="avatar-wrap"><img id="settings-user-avatar" class="user-avatar" alt="User"></div>
                    <div class="user-meta">
                        <div id="settings-user-name" class="user-name">Guest User</div>
                        <div id="settings-user-email" class="user-email">Using app without account</div>
                    </div>
                </div>
                <div class="user-actions">
                    <button id="settings-signin-btn" class="btn btn-primary">Sign In</button>
                    <button id="settings-signout-btn" class="btn btn-secondary hidden">Sign Out</button>
                </div>
            </div>

            <!-- Updates Card (moved just below user section) -->
            <div class="card updates-card">
                <h3>Updates</h3>
                <div class="setting-group">
                    <label>App Version</label>
                    <div id="current-version">‚Äî</div>
                    <small id="latest-version-text" class="hidden"></small>
                </div>
                <div class="setting-group">
                    <label for="update-token">Update Token (Optional)</label>
                    <input type="password" id="update-token" placeholder="GitHub token for private repository access">
                    <small>Required only for private repository updates. Leave blank for public releases.</small>
                </div>
                <div class="setting-group">
                    <button type="button" id="check-update-btn" class="btn btn-secondary">Check for Updates</button>
                    <div id="update-progress" class="hidden" style="margin-top:8px"><small>Preparing update‚Ä¶</small></div>
                </div>
            </div>

            <!-- AI Settings Card -->
            <div class="card">
                <h3>AI Settings</h3>
                <div class="grid-2">
                    <div class="setting-group">
                        <label for="provider-select">AI Provider</label>
                        <select id="provider-select">
                            <option value="ollama">Ollama (Local)</option>
                            <option value="gemini">Gemini (Cloud)</option>
                        </select>
                        <small>Choose between local Ollama or cloud-based Gemini AI</small>
                    </div>

                    <div class="setting-group">
                        <label for="ollama-model">Ollama Model</label>
                        <div style="position: relative;">
                            <select id="ollama-model" class="ollama-model-select">
                                <option value="">Loading models...</option>
                            </select>
                            <button type="button" id="refresh-ollama-models" class="btn btn-secondary" style="position: absolute; right: 0; top: 0; padding: 8px 12px;" title="Refresh Ollama models">üîÑ</button>
                        </div>
                        <small id="ollama-status-text">Checking Ollama status...</small>
                    </div>

                    <div class="setting-group">
                        <label for="gemini-model">Gemini Model</label>
                        <select id="gemini-model">
                            <option value="gemini-2.0-flash">gemini-2.0-flash</option>
                            <option value="gemini-1.5-flash">gemini-1.5-flash</option>
                            <option value="gemini-1.5-pro">gemini-1.5-pro</option>
                        </select>
                        <small>Gemini model to use for AI responses</small>
                    </div>

                    <div class="setting-group span-2">
                        <label for="gemini-api-key">Gemini API Key</label>
                        <div class="api-key-group">
                            <input type="password" id="gemini-api-key" placeholder="Enter your Gemini API key" autocomplete="off" spellcheck="false">
                            <button type="button" id="paste-key-btn" class="btn btn-secondary" title="Paste from clipboard">üìã</button>
                            <button type="button" id="toggle-key-visibility" class="btn btn-secondary" title="Toggle visibility">üëÅ</button>
                        </div>
                        <small>
                            Get your API key from
                            <a href="https://aistudio.google.com/apikey" target="_blank">Google AI Studio</a>
                            <br>
                            <em>Tip: Copy your API key, then click the üìã button to paste it</em>
                        </small>
                    </div>
                </div>
            </div>

            <!-- Appearance & Shortcuts Card -->
            <div class="card">
                <h3>Appearance & Shortcuts</h3>
                <div class="grid-2">
                    <div class="setting-group">
                        <label for="theme-select">Theme</label>
                        <select id="theme-select">
                            <option value="dark">Dark</option>
                            <option value="light">Light</option>
                            <option value="glass">Glass</option>
                        </select>
                        <small>Choose your preferred visual theme</small>
                    </div>

                    <div class="setting-group">
                        <label for="advanced-mode-toggle">Advanced Hint Mode</label>
                        <div>
                            <input type="checkbox" id="advanced-mode-toggle">
                            <label for="advanced-mode-toggle">Send screenshots directly to the AI (skip OCR)</label>
                        </div>
                        <small>
                            Uses a vision-capable model to read the screenshot and generate hints. Recommended models:
                            <em>gemini-1.5-flash</em> or Ollama vision models like <em>granite3.2-vision:2b</em>.
                        </small>
                    </div>

                    <div class="setting-group span-2">
                        <label>Shortcuts</label>
                        <div class="shortcuts-info">
                            <div class="shortcut-item">
                                <span class="shortcut-key">Cmd+Shift+H</span>
                                <span class="shortcut-desc">Global screenshot capture (macOS)</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-key">Ctrl+Shift+H</span>
                                <span class="shortcut-desc">Global screenshot capture (Windows)</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-key">Cmd/Ctrl+Shift+V</span>
                                <span class="shortcut-desc">Process clipboard (Text or Image)</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-key">Cmd/Ctrl+Shift+S</span>
                                <span class="shortcut-desc">Screenshot selection</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div class="settings-footer">
            <div class="button-group">
                <button type="button" id="cancel-btn" class="btn btn-secondary">Cancel</button>
                <button type="button" id="test-connection-btn" class="btn btn-secondary">Test Connection</button>
                <button type="button" id="save-btn" class="btn btn-primary">Save Settings</button>
            </div>
        </div>

        <!-- Status message -->
        <div id="status-message" class="status-message hidden"></div>
    </div>

    <script src="settings.js"></script>
</body>
</html>
